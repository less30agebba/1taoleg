var ZeroClipboard={version:"1.0.7",clients:{},moviePath:"http://i.fanhuan.org/images/ZeroClipboard.swf",nextId:1,$:function(a){if(typeof(a)=="string"){a=document.getElementById(a)}if(!a.addClass){a.hide=function(){this.style.display="none"};a.show=function(){this.style.display=""};a.addClass=function(b){this.removeClass(b);this.className+=" "+b};a.removeClass=function(e){var c=this.className.split(/\s+/);var b=-1;for(var d=0;d<c.length;d++){if(c[d]==e){b=d;d=c.length}}if(b>-1){c.splice(b,1);this.className=c.join(" ")}return this};a.hasClass=function(b){return !!this.className.match(new RegExp("\\s*"+b+"\\s*"))}}return a},setMoviePath:function(a){this.moviePath=a},dispatch:function(a,b,d){var c=this.clients[a];if(c){c.receiveEvent(b,d)}},register:function(a,b){this.clients[a]=b},getDOMObjectPosition:function(c,a){var b={left:0,top:0,width:c.width?c.width:c.offsetWidth,height:c.height?c.height:c.offsetHeight};while(c&&(c!=a)){b.left+=c.offsetLeft;b.top+=c.offsetTop;c=c.offsetParent}return b},Client:function(a){this.handlers={};this.id=ZeroClipboard.nextId++;this.movieId="ZeroClipboardMovie_"+this.id;ZeroClipboard.register(this.id,this);if(a){this.glue(a)}}};ZeroClipboard.Client.prototype={id:0,ready:false,movie:null,clipText:"",handCursorEnabled:true,cssEffects:true,handlers:null,glue:function(b,e,c){this.domElement=ZeroClipboard.$(b);var f=99;if(this.domElement.style.zIndex){f=parseInt(this.domElement.style.zIndex,10)+1}if(typeof(e)=="string"){e=ZeroClipboard.$(e)}else{if(typeof(e)=="undefined"){e=document.getElementsByTagName("body")[0]}}var a=ZeroClipboard.getDOMObjectPosition(this.domElement,e);this.div=document.createElement("div");var d=this.div.style;d.position="absolute";d.left=""+a.left+"px";d.top=""+a.top+"px";d.width=""+a.width+"px";d.height=""+a.height+"px";d.zIndex=f;if(typeof(c)=="object"){for(addedStyle in c){d[addedStyle]=c[addedStyle]}}e.appendChild(this.div);this.div.innerHTML=this.getHTML(a.width,a.height)},getHTML:function(c,b){var e="";var a="id="+this.id+"&width="+c+"&height="+b;if(navigator.userAgent.match(/MSIE/)){var d=location.href.match(/^https/i)?"https://":"http://";e+='<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="'+d+'download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,0,0" width="'+c+'" height="'+b+'" id="'+this.movieId+'" align="middle"><param name="allowScriptAccess" value="always" /><param name="allowFullScreen" value="false" /><param name="movie" value="'+ZeroClipboard.moviePath+'" /><param name="loop" value="false" /><param name="menu" value="false" /><param name="quality" value="best" /><param name="bgcolor" value="#ffffff" /><param name="flashvars" value="'+a+'"/><param name="wmode" value="transparent"/></object>'}else{e+='<embed id="'+this.movieId+'" src="'+ZeroClipboard.moviePath+'" loop="false" menu="false" quality="best" bgcolor="#ffffff" width="'+c+'" height="'+b+'" name="'+this.movieId+'" align="middle" allowScriptAccess="always" allowFullScreen="false" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" flashvars="'+a+'" wmode="transparent" />'}return e},hide:function(){if(this.div){this.div.style.left="-2000px"}},show:function(){this.reposition()},destroy:function(){if(this.domElement&&this.div){this.hide();this.div.innerHTML="";var a=document.getElementsByTagName("body")[0];try{a.removeChild(this.div)}catch(b){}this.domElement=null;this.div=null}},reposition:function(b){if(b){this.domElement=ZeroClipboard.$(b);if(!this.domElement){this.hide()}}if(this.domElement&&this.div){var c=ZeroClipboard.getDOMObjectPosition(this.domElement);var a=this.div.style;a.left=""+c.left+"px";a.top=""+c.top+"px"}},setText:function(a){this.clipText=a;if(this.ready){this.movie.setText(a)}},addEventListener:function(b,a){b=b.toString().toLowerCase().replace(/^on/,"");if(!this.handlers[b]){this.handlers[b]=[]}this.handlers[b].push(a)},setHandCursor:function(a){this.handCursorEnabled=a;if(this.ready){this.movie.setHandCursor(a)}},setCSSEffects:function(a){this.cssEffects=!!a},receiveEvent:function(d,f){d=d.toString().toLowerCase().replace(/^on/,"");switch(d){case"load":this.movie=document.getElementById(this.movieId);if(!this.movie){var b=this;setTimeout(function(){b.receiveEvent("load",null)},1);return}if(!this.ready&&navigator.userAgent.match(/Firefox/)&&navigator.userAgent.match(/Windows/)){var b=this;setTimeout(function(){b.receiveEvent("load",null)},100);this.ready=true;return}this.ready=true;this.movie.setText(this.clipText);this.movie.setHandCursor(this.handCursorEnabled);break;case"mouseover":if(this.domElement&&this.cssEffects){this.domElement.addClass("hover");if(this.recoverActive){this.domElement.addClass("active")}}break;case"mouseout":if(this.domElement&&this.cssEffects){this.recoverActive=false;if(this.domElement.hasClass("active")){this.domElement.removeClass("active");this.recoverActive=true}this.domElement.removeClass("hover")}break;case"mousedown":if(this.domElement&&this.cssEffects){this.domElement.addClass("active")}break;case"mouseup":if(this.domElement&&this.cssEffects){this.domElement.removeClass("active");this.recoverActive=false}break}if(this.handlers[d]){for(var e=0,c=this.handlers[d].length;e<c;e++){var a=this.handlers[d][e];if(typeof(a)=="function"){a(this,f)}else{if((typeof(a)=="object")&&(a.length==2)){a[0][a[1]](this,f)}else{if(typeof(a)=="string"){window[a](this,f)}}}}}}};
